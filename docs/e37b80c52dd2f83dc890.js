function asyncGeneratorStep(e,n,t,r,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void t(e)}o.done?n(l):Promise.resolve(l).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function s(e){asyncGeneratorStep(i,r,a,s,o,"next",e)}function o(e){asyncGeneratorStep(i,r,a,s,o,"throw",e)}s(void 0)}))}}var __generator=this&&this.__generator||function(e,n){var t,r,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(e,s)}catch(e){i=[6,e],r=0}finally{t=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},VERSION=6,log=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t]},PREFIX="/python-wasm-sw/";function delay(e){return new Promise((function(n){return setTimeout(n,e)}))}function handleSleep(e){return _handleSleep.apply(this,arguments)}function _handleSleep(){return(_handleSleep=_asyncToGenerator((function(e){var n,t,r;return __generator(this,(function(a){switch(a.label){case 0:return[4,e.request.json()];case 1:return n=a.sent(),r=null!==(t=Math.round(null==n?void 0:n.ms))&&void 0!==t?t:100,log("sleep",r),[4,delay(r)];case 2:return a.sent(),[2,new Response({status:304})]}}))}))).apply(this,arguments)}self.addEventListener("install",(function(e){log("install  - python-wasm service worker, version: ",VERSION,e)})),self.addEventListener("activate",(function(e){log("activate - python-wasm service worker, version: ",VERSION,e)}));var cache={sig:{},stdin:{},callOnStdin:{}};function handleWriteSignal(e){return _handleWriteSignal.apply(this,arguments)}function _handleWriteSignal(){return(_handleWriteSignal=_asyncToGenerator((function(e){var n,t,r;return __generator(this,(function(a){switch(a.label){case 0:return[4,e.request.json()];case 1:return n=a.sent(),t=n.sig,r=n.id,log("signal",{id:r,sig:t}),cache.sig[r]=t,[2,new Response("".concat(t),{status:200})]}}))}))).apply(this,arguments)}function handleReadSignal(e){return _handleReadSignal.apply(this,arguments)}function _handleReadSignal(){return(_handleReadSignal=_asyncToGenerator((function(e){var n,t,r,a,i;return __generator(this,(function(s){switch(s.label){case 0:return[4,e.request.json()];case 1:return n=s.sent(),t=n.clear,r=n.id,i=null!==(a=cache.sig[r])&&void 0!==a?a:0,t&&(cache.sig[r]=0),[2,new Response("".concat(i),{status:200})]}}))}))).apply(this,arguments)}function handleWriteStdin(e){return _handleWriteStdin.apply(this,arguments)}function _handleWriteStdin(){return(_handleWriteStdin=_asyncToGenerator((function(e){var n,t,r,a;return __generator(this,(function(i){switch(i.label){case 0:return[4,e.request.json()];case 1:return n=i.sent(),t=n.data,r=n.id,log("write to stdin",{id:r,data:t}),null==cache.stdin[r]?cache.stdin[r]=t:cache.stdin[r]+=t,null!=(a=cache.callOnStdin[r])&&(a(),cache.callOnStdin[r]=null),[2,new Response("".concat(cache.stdin[r].length),{status:200})]}}))}))).apply(this,arguments)}function waitForStdin(e){return _waitForStdin.apply(this,arguments)}function _waitForStdin(){return _waitForStdin=_asyncToGenerator((function(e){var n,t=arguments;return __generator(this,(function(r){switch(r.label){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:3e3,cache.stdin[e]?[2]:[4,new Promise((function(t,r){var a=!1,i=!1,s=0;cache.callOnStdin[e]=function(){i||(clearTimeout(s),a=!0,t())},s=setTimeout((function(){a||(cache.callOnStdin[e]=null,i=!0,r("timeout"))}),n)}))];case 1:return r.sent(),[2]}}))})),_waitForStdin.apply(this,arguments)}function handleReadStdin(e){return _handleReadStdin.apply(this,arguments)}function _handleReadStdin(){return(_handleReadStdin=_asyncToGenerator((function(e){var n,t,r,a;return __generator(this,(function(i){switch(i.label){case 0:return[4,e.request.json()];case 1:n=i.sent(),t=n.id,r=n.ms,log("read from stdin",{id:t}),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,waitForStdin(t,null!=r?r:3e3)];case 3:case 4:return i.sent(),[3,5];case 5:return a=cache.stdin[t],cache.stdin[t]="",[2,new Response(a,{status:200})]}}))}))).apply(this,arguments)}self.addEventListener("fetch",(function(e){var n=new URL(e.request.url).pathname;if(!n.startsWith(PREFIX))return!1;switch(n.slice(PREFIX.length)){case"sleep":return void e.respondWith(handleSleep(e));case"write-stdin":return void e.respondWith(handleWriteStdin(e));case"read-stdin":return void e.respondWith(handleReadStdin(e));case"write-signal":return void e.respondWith(handleWriteSignal(e));case"read-signal":return void e.respondWith(handleReadSignal(e))}}));